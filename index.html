<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WUIZZIZZZ - OSN IPS</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-orange: #ff6b00;
            --secondary-yellow: #f4c425;
            --creamy-peach: #FFE8B0;
            --background-light: #f0f0f0;
            --text-color-light: #333;
            --card-bg-light: #fff;
            --correct-green: #28a745;
            --wrong-red: #dc3545;
        }

        body.dark-mode {
            --background-light: #121212;
            --text-color-light: #e0e0e0;
            --card-bg-light: #2c2c2c;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            background-color: var(--background-light);
            color: var(--text-color-light);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            text-align: center;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 700px;
            background-color: var(--creamy-peach);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .dark-mode-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            cursor: pointer;
            font-size: 24px;
        }

        #start-page, #quiz-page, #results-page {
            display: none;
            flex-direction: column;
            gap: 20px;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            font-size: 3rem;
            color: var(--primary-orange);
            text-shadow: 2px 2px var(--secondary-yellow);
            margin-bottom: 10px;
        }
        h2 {
            font-size: 2rem;
            color: var(--primary-orange);
        }

        p {
            font-size: 1.2rem;
            line-height: 1.6;
        }

        .cta-button {
            background-color: var(--primary-orange);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.5rem;
            font-weight: 700;
            cursor: pointer;
            text-transform: uppercase;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s, background-color 0.2s;
        }
        .cta-button:hover {
            background-color: #e55b00;
            transform: translateY(-3px);
        }

        #quiz-page {
            text-align: left;
        }

        #progress-bar {
            width: 100%;
            height: 15px;
            background-color: #ddd;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
            border: 2px solid var(--secondary-yellow);
        }

        #time-bar {
            width: 100%;
            height: 100%;
            background-color: var(--primary-orange);
            border-radius: 10px;
            transition: width 0.1s linear;
        }

        #question-counter {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-orange);
        }
        
        #current-score {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-orange);
            text-align: right;
        }

        .question-card {
            background-color: var(--card-bg-light);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-top: 15px;
        }
        .question-card h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option-button {
            background-color: var(--secondary-yellow);
            color: var(--text-color-light);
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1.2rem;
            text-align: left;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
            display: flex;
            align-items: center;
        }
        .option-button:hover:not(:disabled) {
            background-color: #e5b321;
            transform: translateX(5px);
        }
        .option-button:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }

        .option-button.correct {
            background-color: var(--correct-green);
            color: white;
            animation: pop 0.5s ease-in-out;
        }
        .option-button.wrong {
            background-color: var(--wrong-red);
            color: white;
            animation: shake 0.5s ease-in-out;
        }
        
        .option-button span {
            font-weight: 700;
            margin-right: 15px;
            min-width: 25px;
            display: inline-block;
        }

        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }

        #short-answer-input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--secondary-yellow);
            border-radius: 10px;
            font-size: 1.2rem;
            margin-top: 15px;
            background-color: var(--card-bg-light);
            color: var(--text-color-light);
            text-transform: uppercase;
        }

        #submit-answer-btn {
            margin-top: 15px;
            width: 100%;
        }

        #results-page h2 {
            margin-bottom: 20px;
        }
        .result-details {
            display: flex;
            flex-direction: column;
            gap: 10px;
            background-color: var(--card-bg-light);
            padding: 20px;
            border-radius: 15px;
            text-align: left;
        }
        .result-details p {
            font-size: 1.2rem;
            font-weight: 600;
        }
        .result-details p span {
            color: var(--primary-orange);
            float: right;
        }

        .results-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }
        .results-buttons button {
            flex: 1;
        }
        
        #leaderboard {
            margin-top: 25px;
            background-color: var(--card-bg-light);
            padding: 20px;
            border-radius: 15px;
            text-align: left;
        }
        #leaderboard h3 {
            font-size: 1.5rem;
            color: var(--primary-orange);
            margin-bottom: 15px;
        }
        #leaderboard ol {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        #leaderboard li {
            padding: 10px;
            font-size: 1.1rem;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        #leaderboard li:last-child {
            border-bottom: none;
        }
        #leaderboard li span:last-child {
            font-weight: 700;
            color: var(--primary-orange);
        }

        #player-name-input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--secondary-yellow);
            border-radius: 10px;
            font-size: 1.2rem;
            margin-top: 15px;
            background-color: var(--card-bg-light);
            color: var(--text-color-light);
            text-align: center;
        }
        
        .logo {
            width: 80%;
            max-width: 400px;
            height: auto;
            margin-bottom: 20px;
        }

        @media (max-width: 600px) {
            h1 { font-size: 2.5rem; }
            h2 { font-size: 1.8rem; }
            p { font-size: 1rem; }
            .cta-button { font-size: 1.2rem; padding: 12px 25px; }
            .question-card h3 { font-size: 1.3rem; }
            .option-button { font-size: 1rem; padding: 12px; }
            .result-details p { font-size: 1rem; }
            .results-buttons { flex-direction: column; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="dark-mode-toggle" id="darkModeToggle">ðŸŒ™</div>

    <div id="start-page" style="display: flex;">
        <img src="https://i.ibb.co/3s3B4wG/wuizzizzz-logo.png" alt="WUIZZIZZZ Logo" class="logo">
        <h1 style="color: var(--primary-orange); text-shadow: 2px 2px var(--secondary-yellow);">WUIZZIZZZ</h1>
        <p>Ayo, uji kemampuanmu di **Olimpiade Sains Nasional IPS**! ðŸš€</p>
        <p style="font-weight: bold; font-size: 1rem; color: #ff6b00; margin-top: 20px;">
            <i class="fas fa-info-circle"></i>
            CATATAN: Untuk soal isian singkat, jawab dengan huruf kapital semua, tanpa tanda baca.
        </p>
        <button id="start-button" class="cta-button">Mulai Kuis</button>
        <div id="leaderboard">
            <h3>Leaderboard Lokal</h3>
            <ol id="leaderboard-list">
                </ol>
        </div>
    </div>

    <div id="quiz-page">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
            <span id="question-counter">1/50</span>
            <div style="display: flex; align-items: center; gap: 10px;">
                <span id="score-display">Skor: 0</span>
            </div>
        </div>
        <div id="progress-bar"><div id="time-bar"></div></div>
        <div class="question-card">
            <h3 id="question-text"></h3>
            <img id="question-image" style="width: 100%; max-width: 400px; height: auto; border-radius: 10px; margin-bottom: 15px; display: none;">
            <div id="options-container" class="options-container">
                </div>
            <input type="text" id="short-answer-input" placeholder="JAWABANMU" style="display: none;">
            <button id="submit-answer-btn" class="cta-button" style="display: none;">Kirim Jawaban</button>
        </div>
    </div>

    <div id="results-page">
        <h2>Hasil Kuis</h2>
        <div class="result-details">
            <p>Total Skor: <span id="final-score"></span></p>
            <p>Jawaban Benar: <span id="correct-answers"></span></p>
            <p>Jawaban Salah: <span id="wrong-answers"></span></p>
            <p>Waktu Pengerjaan: <span id="time-taken"></span></p>
        </div>
        <input type="text" id="player-name-input" placeholder="Masukkan nama kamu" maxlength="20">
        <div class="results-buttons">
            <button id="play-again-button" class="cta-button">Main Lagi</button>
            <button id="share-score-button" class="cta-button">Bagikan Skor</button>
        </div>
    </div>
</div>

<script>
    const questions = [
        // Pilihan Ganda (30 Soal)
        {
            type: 'multiple-choice',
            question: 'Luas laut Indonesia mencakup 2/3 dari seluruh luas wilayah Indonesia dan memiliki garis pantai terpanjang kedua di dunia dengan berbagai potensi sumberdaya air laut yang perlu dikelola dengan baik. Salah satu potensi sumber daya air laut adalah pemanfaatannya untuk pembuatan garam. Secara geografis wilayah yang paling berpotensi untuk mendukung kegiatan tersebut adalah pesisir ....',
            options: ['A Utara Papua', 'B Timur Kalimantan', 'C Selatan Sulawesi', 'D Barat Sumatera'],
            answer: 'C Selatan Sulawesi'
        },
        {
            type: 'multiple-choice',
            question: 'Sistem ekonomi di Indonesia sering disebut sebagai ekonomi Pancasila. Salah satu ciri khasnya adalah ....',
            options: ['A dominasi modal asing', 'B peran negara yang minimal', 'C gotong royong dan kekeluargaan', 'D persaingan bebas tanpa batas'],
            answer: 'C gotong royong dan kekeluargaan'
        },
        {
            type: 'multiple-choice',
            question: 'Pola persebaran penduduk Indonesia tidak merata, mayoritas penduduk terkonsentrasi di Pulau Jawa. Upaya pemerintah untuk mengatasi masalah ini adalah ....',
            options: ['A urbanisasi', 'B transmigrasi', 'C imigrasi', 'D emigrasi'],
            answer: 'B transmigrasi'
        },
        {
            type: 'multiple-choice',
            question: 'Manusia purba yang ditemukan di Sangiran, Jawa Tengah, dikenal dengan nama ....',
            options: ['A Meganthropus Palaeojavanicus', 'B Homo Wajakensis', 'C Homo Erectus', 'D Pithecanthropus Erectus'],
            answer: 'D Pithecanthropus Erectus'
        },
        {
            type: 'multiple-choice',
            question: 'Berikut ini adalah contoh dari sumber daya alam yang dapat diperbarui (renewable resources), kecuali ....',
            options: ['A air', 'B tanah', 'C batu bara', 'D angin'],
            answer: 'C batu bara'
        },
        {
            type: 'multiple-choice',
            question: 'Peran utama koperasi dalam perekonomian Indonesia adalah ....',
            options: ['A meningkatkan keuntungan individu', 'B menggerakkan pasar modal', 'C meningkatkan kesejahteraan anggota', 'D dominasi ekonomi pasar'],
            answer: 'C meningkatkan kesejahteraan anggota'
        },
        {
            type: 'multiple-choice',
            question: 'Salah satu faktor penyebab terjadinya tsunami adalah ....',
            options: ['A angin kencang', 'B letusan gunung berapi bawah laut', 'C hujan deras', 'D pasang surut air laut'],
            answer: 'B letusan gunung berapi bawah laut'
        },
        {
            type: 'multiple-choice',
            question: 'Berikut ini adalah salah satu upaya untuk menjaga kelestarian lingkungan hidup, yaitu ....',
            options: ['A membuka lahan gambut', 'B reboisasi', 'C penggunaan plastik berlebihan', 'D pembuangan limbah ke sungai'],
            answer: 'B reboisasi'
        },
        {
            type: 'multiple-choice',
            question: 'Masa praaksara di Indonesia dibagi menjadi beberapa zaman. Zaman di mana manusia mulai mengenal bercocok tanam dan beternak disebut zaman ....',
            options: ['A Batu Tua', 'B Batu Madya', 'C Batu Muda', 'D Batu Besar'],
            answer: 'C Batu Muda'
        },
        {
            type: 'multiple-choice',
            question: 'Perdagangan internasional didorong oleh adanya perbedaan .... antarnegara.',
            options: ['A iklim', 'B sumber daya dan teknologi', 'C bahasa', 'D budaya'],
            answer: 'B sumber daya dan teknologi'
        },
        {
            type: 'multiple-choice',
            question: 'Kebijakan pemerintah untuk menstabilkan harga barang dan jasa disebut kebijakan ....',
            options: ['A moneter', 'B fiskal', 'C politik', 'D sosial'],
            answer: 'A moneter'
        },
        {
            type: 'multiple-choice',
            question: 'Organisasi internasional yang bertujuan untuk memelihara perdamaian dan keamanan dunia adalah ....',
            options: ['A WHO', 'B UNESCO', 'C PBB', 'D NATO'],
            answer: 'C PBB'
        },
        {
            type: 'multiple-choice',
            question: 'Bentuk muka bumi yang ditandai dengan dataran tinggi yang luas dan datar disebut ....',
            options: ['A pegunungan', 'B dataran rendah', 'C plato', 'D lembah'],
            answer: 'C plato'
        },
        {
            type: 'multiple-choice',
            question: 'Ciri-ciri masyarakat agraris adalah ....',
            options: ['A sebagian besar penduduk bekerja di bidang industri', 'B sebagian besar penduduk bekerja di bidang pertanian', 'C sebagian besar penduduk bekerja di sektor jasa', 'D sebagian besar penduduk tinggal di perkotaan'],
            answer: 'B sebagian besar penduduk bekerja di bidang pertanian'
        },
        {
            type: 'multiple-choice',
            question: 'Salah satu dampak negatif globalisasi adalah ....',
            options: ['A kemajuan teknologi', 'B kemudahan informasi', 'C lunturnya nilai-nilai budaya lokal', 'D peningkatan kerja sama internasional'],
            answer: 'C lunturnya nilai-nilai budaya lokal'
        },
        {
            type: 'multiple-choice',
            question: 'Pembagian wilayah Indonesia menjadi Waktu Indonesia Barat (WIB), Waktu Indonesia Tengah (WITA), dan Waktu Indonesia Timur (WIT) didasarkan pada ....',
            options: ['A garis lintang', 'B garis bujur', 'C iklim', 'D kepadatan penduduk'],
            answer: 'B garis bujur'
        },
        {
            type: 'multiple-choice',
            question: 'Faktor pendorong mobilitas sosial adalah ....',
            options: ['A kemiskinan', 'B pendidikan yang rendah', 'C status sosial yang tertutup', 'D status sosial yang terbuka'],
            answer: 'D status sosial yang terbuka'
        },
        {
            type: 'multiple-choice',
            question: 'Peninggalan sejarah berupa bangunan suci tempat pemujaan roh nenek moyang pada masa megalitikum adalah ....',
            options: ['A menhir', 'B punden berundak', 'C sarkofagus', 'D dolmen'],
            answer: 'B punden berundak'
        },
        {
            type: 'multiple-choice',
            question: 'Berikut adalah contoh interaksi antara manusia dengan lingkungan sosial, yaitu ....',
            options: ['A petani menanam padi', 'B nelayan menangkap ikan', 'C pedagang bertransaksi dengan pembeli', 'D penambang menggali batu bara'],
            answer: 'C pedagang bertransaksi dengan pembeli'
        },
        {
            type: 'multiple-choice',
            question: 'Kegiatan ekonomi yang mengubah bahan mentah menjadi barang jadi disebut ....',
            options: ['A konsumsi', 'B produksi', 'C distribusi', 'D impor'],
            answer: 'B produksi'
        },
        {
            type: 'multiple-choice',
            question: 'Candi Borobudur dibangun pada masa kerajaan ....',
            options: ['A Mataram Hindu', 'B Majapahit', 'C Sriwijaya', 'D Singasari'],
            answer: 'A Mataram Hindu'
        },
        {
            type: 'multiple-choice',
            question: 'Permasalahan sosial yang terjadi karena perbedaan kelas ekonomi disebut ....',
            options: ['A kriminalitas', 'B kemiskinan', 'C disorganisasi keluarga', 'D kenakalan remaja'],
            answer: 'B kemiskinan'
        },
        {
            type: 'multiple-choice',
            question: 'Salah satu tujuan didirikannya ASEAN adalah ....',
            options: ['A membentuk aliansi militer', 'B meningkatkan kerjasama ekonomi, sosial, dan budaya', 'C mendirikan negara federasi', 'D mendominasi ekonomi global'],
            answer: 'B meningkatkan kerjasama ekonomi, sosial, dan budaya'
        },
        {
            type: 'multiple-choice',
            question: 'Pola pemukiman penduduk yang memanjang mengikuti jalur sungai atau jalan raya disebut ....',
            options: ['A menyebar', 'B memanjang', 'C mengelompok', 'D terpusat'],
            answer: 'B memanjang'
        },
        {
            type: 'multiple-choice',
            question: 'Pembentukan gunung berapi terjadi akibat ....',
            options: ['A pergerakan lempeng tektonik', 'B erosi angin', 'C proses sedimentasi', 'D hujan asam'],
            answer: 'A pergerakan lempeng tektonik'
        },
        {
            type: 'multiple-choice',
            question: 'Konflik sosial dapat diatasi dengan cara damai melalui ....',
            options: ['A kekerasan', 'B mediasi', 'C persaingan', 'D paksaan'],
            answer: 'B mediasi'
        },
        {
            type: 'multiple-choice',
            question: 'Pada masa pergerakan nasional, organisasi Budi Utomo didirikan oleh ....',
            options: ['A Soekarno', 'B Mohammad Hatta', 'C dr. Soetomo', 'D Ki Hajar Dewantara'],
            answer: 'C dr. Soetomo'
        },
        {
            type: 'multiple-choice',
            question: 'Faktor utama yang mendorong migrasi penduduk dari desa ke kota adalah ....',
            options: ['A ketersediaan lahan pertanian', 'B fasilitas pendidikan dan pekerjaan yang lebih baik', 'C ikatan kekeluargaan yang kuat', 'D kondisi alam yang lebih subur'],
            answer: 'B fasilitas pendidikan dan pekerjaan yang lebih baik'
        },
        {
            type: 'multiple-choice',
            question: 'Pasar yang hanya menjual satu jenis barang disebut ....',
            options: ['A pasar monopoli', 'B pasar oligopoli', 'C pasar konkret', 'D pasar abstrak'],
            answer: 'A pasar monopoli'
        },
        {
            type: 'multiple-choice',
            question: 'Salah satu ciri sistem ekonomi liberal adalah ....',
            options: ['A campur tangan pemerintah yang besar', 'B peran swasta yang terbatas', 'C kebebasan individu dalam berusaha', 'D kepemilikan alat produksi oleh negara'],
            answer: 'C kebebasan individu dalam berusaha'
        },

        // Isian Singkat (20 Soal)
        {
            type: 'short-answer',
            question: 'Persebaran flora di Indonesia sama dengan pola persebaran faunanya yang berpangkal pada sejarah pembentukan daratan kepulauan Indonesia pada masa zaman es. Pada awal zaman es, Dataran Sunda masih bersatu dengan benua Asia dan Dataran ................. yang menyatu dengan benua Australia merupakan daerah migrasi fauna.',
            answer: 'SAHUL'
        },
        {
            type: 'short-answer',
            question: 'Lembaga yang bertugas untuk menciptakan ketertiban dan keamanan dalam masyarakat adalah lembaga ....',
            answer: 'KEAMANAN'
        },
        {
            type: 'short-answer',
            question: 'Cabang ilmu geografi yang mempelajari tentang keadaan iklim suatu wilayah disebut ....',
            answer: 'KLIMATOLOGI'
        },
        {
            type: 'short-answer',
            question: 'Proses penyebaran kebudayaan dari satu tempat ke tempat lain disebut ....',
            answer: 'AKULTURASI'
        },
        {
            type: 'short-answer',
            question: 'Mata pencaharian penduduk di daerah pantai yang mayoritas adalah ....',
            answer: 'NELAYAN'
        },
        {
            type: 'short-answer',
            question: 'Kerajaan Islam pertama di Indonesia yang berlokasi di Aceh adalah Kerajaan ....',
            answer: 'SAMUDERA PASAI'
        },
        {
            type: 'short-answer',
            question: 'Kondisi air laut yang naik dan menutupi daratan disebut ....',
            answer: 'PASANG'
        },
        {
            type: 'short-answer',
            question: 'Nama tokoh yang memproklamasikan kemerdekaan Indonesia bersama Soekarno adalah ....',
            answer: 'MOHAMMAD HATTA'
        },
        {
            type: 'short-answer',
            question: 'Istilah untuk perpindahan penduduk dari desa ke kota adalah ....',
            answer: 'URBANISASI'
        },
        {
            type: 'short-answer',
            question: 'Peninggalan sejarah berupa bangunan batu besar yang berfungsi sebagai tempat pemujaan adalah ....',
            answer: 'MENHIR'
        },
        {
            type: 'short-answer',
            question: 'Faktor yang menyebabkan perubahan sosial dari luar adalah ....',
            answer: 'INNOVASI'
        },
        {
            type: 'short-answer',
            question: 'Kegiatan ekonomi yang menyalurkan barang dari produsen ke konsumen disebut ....',
            answer: 'DISTRIBUSI'
        },
        {
            type: 'short-answer',
            question: 'Pola hidup yang tidak menghargai waktu dan cenderung santai disebut ....',
            answer: 'TRADISIONAL'
        },
        {
            type: 'short-answer',
            question: 'Salah satu penyebab terjadinya inflasi adalah ....',
            answer: 'PERMINTAAN'
        },
        {
            type: 'short-answer',
            question: 'Organisasi internasional di bidang ekonomi yang berfokus pada perdagangan adalah ....',
            answer: 'WTO'
        },
        {
            type: 'short-answer',
            question: 'Bentuk interaksi sosial yang bertujuan untuk mencapai kesepakatan adalah ....',
            answer: 'KERJASAMA'
        },
        {
            type: 'short-answer',
            question: 'Salah satu contoh sumber daya alam yang tidak dapat diperbarui adalah ....',
            answer: 'MINYAK BUMI'
        },
        {
            type: 'short-answer',
            question: 'Peristiwa perpindahan massa tanah secara tiba-tiba disebut ....',
            answer: 'TANAH LONGSOR'
        },
        {
            type: 'short-answer',
            question: 'Kegiatan ekonomi yang menjual produk ke luar negeri disebut ....',
            answer: 'EKSPOR'
        },
        {
            type: 'short-answer',
            question: 'Istilah untuk proses penyesuaian diri dalam masyarakat adalah ....',
            answer: 'ASIMILASI'
        }
    ];

    const startPage = document.getElementById('start-page');
    const quizPage = document.getElementById('quiz-page');
    const resultsPage = document.getElementById('results-page');
    const startButton = document.getElementById('start-button');
    const playAgainButton = document.getElementById('play-again-button');
    const questionCounter = document.getElementById('question-counter');
    const scoreDisplay = document.getElementById('score-display');
    const questionText = document.getElementById('question-text');
    const questionImage = document.getElementById('question-image');
    const optionsContainer = document.getElementById('options-container');
    const shortAnswerInput = document.getElementById('short-answer-input');
    const submitAnswerBtn = document.getElementById('submit-answer-btn');
    const finalScore = document.getElementById('final-score');
    const correctAnswersCount = document.getElementById('correct-answers');
    const wrongAnswersCount = document.getElementById('wrong-answers');
    const timeTakenSpan = document.getElementById('time-taken');
    const timeBar = document.getElementById('time-bar');
    const shareScoreButton = document.getElementById('share-score-button');
    const playerNameInput = document.getElementById('player-name-input');
    const leaderboardList = document.getElementById('leaderboard-list');
    const darkModeToggle = document.getElementById('darkModeToggle');

    let currentQuestionIndex = 0;
    let score = 0;
    let correctCount = 0;
    let wrongCount = 0;
    let timer;
    let timeRemaining;
    let totalTime = 0;
    let startTime;
    const questionsTotal = questions.length;

    const timerDurations = {
        'multiple-choice': 30,
        'short-answer': 45
    };

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    function startQuiz() {
        shuffleArray(questions);
        startPage.style.display = 'none';
        quizPage.style.display = 'flex';
        currentQuestionIndex = 0;
        score = 0;
        correctCount = 0;
        wrongCount = 0;
        totalTime = 0;
        startTime = new Date();
        scoreDisplay.textContent = 'Skor: ' + score;
        showQuestion();
    }

    function showQuestion() {
        if (currentQuestionIndex >= questionsTotal) {
            showResults();
            return;
        }

        const questionData = questions[currentQuestionIndex];
        questionCounter.textContent = `${currentQuestionIndex + 1}/${questionsTotal}`;
        questionText.innerHTML = questionData.question;
        questionImage.style.display = 'none';
        optionsContainer.innerHTML = '';
        shortAnswerInput.style.display = 'none';
        submitAnswerBtn.style.display = 'none';

        if (questionData.type === 'multiple-choice') {
            optionsContainer.style.display = 'flex';
            shuffleArray(questionData.options);
            const optionLetters = ['A', 'B', 'C', 'D'];
            questionData.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'option-button';
                button.innerHTML = `<span>${optionLetters[index]}</span>${option}`;
                button.onclick = () => checkAnswer(option);
                optionsContainer.appendChild(button);
            });
        } else if (questionData.type === 'short-answer') {
            optionsContainer.style.display = 'none';
            shortAnswerInput.style.display = 'block';
            submitAnswerBtn.style.display = 'block';
            shortAnswerInput.value = '';
            shortAnswerInput.focus();
            submitAnswerBtn.onclick = () => checkAnswer(shortAnswerInput.value.toUpperCase().trim());
        }

        resetTimer(timerDurations[questionData.type]);
    }

    function checkAnswer(userAnswer) {
        clearInterval(timer);
        const questionData = questions[currentQuestionIndex];
        const isCorrect = questionData.type === 'multiple-choice'
            ? userAnswer === questionData.answer
            : userAnswer === questionData.answer;

        const timeSpent = timerDurations[questionData.type] - timeRemaining;
        totalTime += timeSpent;

        if (isCorrect) {
            score += 10;
            correctCount++;
            if (timeSpent < 10) {
                totalTime -= 10; // Bonus waktu
                alert('Waktu Bonus 10 Detik! Keren!');
            }
            if (questionData.type === 'multiple-choice') {
                const correctButton = Array.from(optionsContainer.children).find(btn => btn.textContent.includes(questionData.answer));
                correctButton.classList.add('correct');
            } else {
                shortAnswerInput.style.backgroundColor = varColor('correct-green');
            }
        } else {
            wrongCount++;
            if (questionData.type === 'multiple-choice') {
                const correctButton = Array.from(optionsContainer.children).find(btn => btn.textContent.includes(questionData.answer));
                const userButton = Array.from(optionsContainer.children).find(btn => btn.textContent.includes(userAnswer));
                if (userButton) userButton.classList.add('wrong');
                if (correctButton) correctButton.classList.add('correct');
            } else {
                shortAnswerInput.style.backgroundColor = varColor('wrong-red');
            }
        }

        scoreDisplay.textContent = 'Skor: ' + score;
        disableOptions();
        setTimeout(() => {
            currentQuestionIndex++;
            showQuestion();
        }, 1500);
    }

    function disableOptions() {
        const options = document.querySelectorAll('.option-button');
        options.forEach(button => button.disabled = true);
        if (shortAnswerInput) shortAnswerInput.disabled = true;
        if (submitAnswerBtn) submitAnswerBtn.disabled = true;
    }

    function resetTimer(duration) {
        timeRemaining = duration;
        timeBar.style.width = '100%';
        timeBar.style.backgroundColor = varColor('primary-orange');
        
        timer = setInterval(() => {
            timeRemaining--;
            const percentage = (timeRemaining / duration) * 100;
            timeBar.style.width = percentage + '%';

            if (percentage < 25) {
                timeBar.style.backgroundColor = varColor('wrong-red');
            } else if (percentage < 50) {
                timeBar.style.backgroundColor = varColor('secondary-yellow');
            } else {
                timeBar.style.backgroundColor = varColor('primary-orange');
            }

            if (timeRemaining <= 0) {
                clearInterval(timer);
                wrongCount++;
                totalTime += duration;
                disableOptions();
                
                const questionData = questions[currentQuestionIndex];
                if (questionData.type === 'multiple-choice') {
                    const correctButton = Array.from(optionsContainer.children).find(btn => btn.textContent.includes(questionData.answer));
                    if (correctButton) correctButton.classList.add('correct');
                }
                
                setTimeout(() => {
                    currentQuestionIndex++;
                    showQuestion();
                }, 1500);
            }
        }, 1000);
    }

    function varColor(variable) {
        return getComputedStyle(document.documentElement).getPropertyValue('--' + variable);
    }

    function showResults() {
        quizPage.style.display = 'none';
        resultsPage.style.display = 'flex';
        
        finalScore.textContent = score;
        correctAnswersCount.textContent = correctCount;
        wrongAnswersCount.textContent = wrongCount;
        timeTakenSpan.textContent = formatTime(totalTime);

        saveScoreToLeaderboard(playerNameInput.value || 'Anonim', score, totalTime);
    }

    function formatTime(seconds) {
        const minutes = Math.floor(seconds / 60);
        const remainingSeconds = seconds % 60;
        return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
    }

    function saveScoreToLeaderboard(name, score, time) {
        const leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];
        leaderboard.push({ name, score, time });
        leaderboard.sort((a, b) => {
            if (b.score !== a.score) {
                return b.score - a.score;
            }
            return a.time - b.time;
        });
        localStorage.setItem('leaderboard', JSON.stringify(leaderboard.slice(0, 5)));
        renderLeaderboard();
    }

    function renderLeaderboard() {
        const leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];
        leaderboardList.innerHTML = '';
        if (leaderboard.length === 0) {
            leaderboardList.innerHTML = '<li>Belum ada data skor.</li>';
        } else {
            leaderboard.forEach((entry, index) => {
                const li = document.createElement('li');
                li.innerHTML = `<span>${index + 1}. ${entry.name}</span><span>Skor: ${entry.score} - Waktu: ${formatTime(entry.time)}</span>`;
                leaderboardList.appendChild(li);
            });
        }
    }

    function shareScore() {
        const text = `ðŸŽ‰ Aku berhasil meraih skor ${score} di WUIZZIZZZ - OSN IPS dalam waktu ${formatTime(totalTime)}! Ayo coba tantanganku! #WUIZZIZZZ #OSNIPS`;
        if (navigator.share) {
            navigator.share({
                title: 'Hasil Kuis WUIZZIZZZ',
                text: text,
                url: window.location.href,
            }).catch(error => console.error('Error sharing:', error));
        } else {
            alert(text);
        }
    }

    function toggleDarkMode() {
        document.body.classList.toggle('dark-mode');
        const isDarkMode = document.body.classList.contains('dark-mode');
        darkModeToggle.textContent = isDarkMode ? 'â˜€ï¸' : 'ðŸŒ™';
    }

    startButton.addEventListener('click', startQuiz);
    playAgainButton.addEventListener('click', () => {
        resultsPage.style.display = 'none';
        startPage.style.display = 'flex';
        renderLeaderboard();
    });
    shareScoreButton.addEventListener('click', shareScore);
    darkModeToggle.addEventListener('click', toggleDarkMode);
    
    // Initial calls
    renderLeaderboard();
    document.getElementById('start-page').style.display = 'flex';
</script>

</body>
</html>
