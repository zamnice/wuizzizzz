<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WUIZZIZZZ - OSN IPS</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #ff6b00, #f4c425);
        }
        .dark-mode {
            background: linear-gradient(135deg, #333, #555);
            color: #fff;
        }
        .btn {
            transition: all 0.3s ease;
        }
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        .option:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        .correct {
            animation: correct 0.5s ease;
        }
        .wrong {
            animation: wrong 0.5s ease;
        }
        @keyframes correct {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        @keyframes wrong {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-10px); }
            100% { transform: translateX(0); }
        }
        .pulse {
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        .dark-mode-toggle {
            position: fixed;
            top: 20px;
            right: 50px;
        }
        .question-text {
            font-size: 1.1rem;
        }
        @media (max-width: 600px) {
            .question-text {
                font-size: 0.9rem;
            }
            .dark-mode-toggle {
                right: 30px;
            }
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div class="dark-mode-toggle bg-orange-500 text-white p-2 rounded-full cursor-pointer" onclick="toggleDarkMode()">ðŸŒ™</div>
    <div class="container max-w-3xl mx-auto p-4">
        <div class="start-screen bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-lg">
            <h1 class="text-4xl font-bold text-orange-500 mb-4 animate-bounce">WUIZZIZZZ - OSN IPS</h1>
            <p class="text-lg text-gray-600 dark:text-gray-300 mb-6">
                Tantang dirimu dengan 50 soal OSN IPS level nasional! ðŸ’ª Jawab 30 soal pilihan ganda (30 detik/soal) dan 20 soal isian singkat (45 detik/soal). Jawaban isian harus dalam <strong>HURUF BESAR</strong> tanpa tanda baca. Dapatkan <strong>power-up</strong> (ðŸ”¥ +10 detik) jika menjawab dalam 10 detik! Pilih hingga 3 soal untuk redemption quiz di akhir. Ayo raih skor tertinggi! ðŸš€
            </p>
            <button class="btn bg-orange-500 text-white px-6 py-3 rounded-lg font-semibold" onclick="startQuiz()">Mulai Kuis</button>
            <button class="btn bg-yellow-400 text-gray-800 px-6 py-3 rounded-lg font-semibold ml-4" onclick="showAdmin()">Tambah Soal (Admin)</button>
        </div>

        <div class="question-screen hidden">
            <div class="nav-card bg-white dark:bg-gray-800 rounded-2xl p-4 mb-4 shadow-lg flex justify-between items-center">
                <div class="score text-lg font-semibold text-orange-500">Skor: 0</div>
                <div class="powerup hidden text-2xl pulse">ðŸ”¥</div>
                <div class="timer flex items-center">
                    <div class="timer-bar w-32 h-2 bg-gray-300 rounded-full overflow-hidden mr-2">
                        <div class="timer-progress h-full bg-yellow-400" style="width: 100%;"></div>
                    </div>
                    <span class="timer-text text-gray-600 dark:text-gray-300">30 detik</span>
                </div>
            </div>
            <div class="question-card bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg">
                <div class="question-number text-lg font-semibold text-gray-600 dark:text-gray-300 mb-2"></div>
                <div class="question-text mb-4"></div>
                <div class="options grid gap-3"></div>
                <div class="short-answer hidden">
                    <input type="text" class="w-full p-3 border-2 border-orange-500 rounded-lg text-uppercase" placeholder="Masukkan jawaban (HURUF BESAR, TANPA TANDA BACA)">
                    <button class="btn bg-orange-500 text-white px-6 py-3 rounded-lg font-semibold mt-3" onclick="checkShortAnswer()">Kirim</button>
                </div>
            </div>
        </div>

        <div class="result-screen hidden bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-lg">
            <h2 class="text-2xl font-bold text-orange-500 mb-4">Hasil Kuis</h2>
            <p id="total-score" class="text-lg mb-2"></p>
            <p id="correct-answers" class="text-lg mb-2"></p>
            <p id="time-taken" class="text-lg mb-4"></p>
            <div class="redemption hidden mb-4">
                <h3 class="text-lg font-semibold text-gray-600 dark:text-gray-300">Redemption Quiz</h3>
                <p class="text-gray-600 dark:text-gray-300 mb-2">Pilih hingga 3 soal yang salah/tidak dijawab untuk dijawab ulang:</p>
                <div id="redemption-options" class="flex flex-wrap gap-2"></div>
                <button class="btn bg-orange-500 text-white px-6 py-3 rounded-lg font-semibold mt-3" onclick="startRedemption()">Mulai Redemption</button>
            </div>
            <button class="btn bg-orange-500 text-white px-6 py-3 rounded-lg font-semibold" onclick="playAgain()">Main Lagi</button>
            <button class="btn bg-yellow-400 text-gray-800 px-6 py-3 rounded-lg font-semibold ml-4" onclick="shareScore()">Bagikan Skor</button>
            <div class="leaderboard mt-6">
                <h3 class="text-lg font-semibold text-gray-600 dark:text-gray-300">Leaderboard</h3>
                <ul id="leaderboard-list" class="text-left"></ul>
            </div>
        </div>

        <div class="admin-section hidden bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-lg">
            <h2 class="text-2xl font-bold text-orange-500 mb-4">Tambah Soal Baru</h2>
            <select id="question-type" class="w-full p-3 border rounded-lg mb-4">
                <option value="multiple">Pilihan Ganda</option>
                <option value="short">Isian Singkat</option>
            </select>
            <textarea id="question-text" class="w-full p-3 border rounded-lg mb-4" placeholder="Masukkan teks soal"></textarea>
            <input id="option-a" class="w-full p-3 border rounded-lg mb-4 hidden" placeholder="Pilihan A">
            <input id="option-b" class="w-full p-3 border rounded-lg mb-4 hidden" placeholder="Pilihan B">
            <input id="option-c" class="w-full p-3 border rounded-lg mb-4 hidden" placeholder="Pilihan C">
            <input id="option-d" class="w-full p-3 border rounded-lg mb-4 hidden" placeholder="Pilihan D">
            <input id="correct-answer" class="w-full p-3 border rounded-lg mb-4" placeholder="Jawaban benar (A/B/C/D untuk pilihan ganda, teks untuk isian)">
            <button class="btn bg-orange-500 text-white px-6 py-3 rounded-lg font-semibold" onclick="addQuestion()">Tambah Soal</button>
            <button class="btn bg-yellow-400 text-gray-800 px-6 py-3 rounded-lg font-semibold ml-4" onclick="hideAdmin()">Kembali</button>
        </div>
    </div>

    <script>
        const questions = [
            // 30 Multiple-Choice Questions (Challenging, OSN IPS Level)
            {
                type: "multiple",
                text: "Luas laut Indonesia mencakup 2/3 dari seluruh luas wilayah Indonesia dan memiliki garis pantai terpanjang kedua di dunia. Salah satu potensi sumber daya air laut adalah pemanfaatannya untuk pembuatan garam. Secara geografis, wilayah yang paling berpotensi untuk mendukung kegiatan tersebut adalah pesisir ....",
                options: ["Utara Papua", "Timur Kalimantan", "Selatan Sulawesi", "Barat Sumatera"],
                correct: "C"
            },
            {
                type: "multiple",
                text: "Pada masa kolonial Belanda, sistem tanam paksa (Cultuurstelsel) diterapkan untuk memaksimalkan ekspor komoditas. Salah satu dampak sosial dari sistem ini adalah ....",
                options: ["Peningkatan kesejahteraan petani", "Penurunan jumlah penduduk desa", "Peningkatan migrasi ke kota", "Pemusatan kekayaan di tangan bangsawan lokal"],
                correct: "B"
            },
            {
                type: "multiple",
                text: "Interaksi antara lempeng tektonik Indo-Australia dan Eurasia menyebabkan aktivitas vulkanik di Indonesia. Fenomena geologis ini paling dominan di wilayah ....",
                options: ["Cincin Api Pasifik", "Dataran Sunda", "Lempeng Sahul", "Pegunungan Himalaya"],
                correct: "A"
            },
            {
                type: "multiple",
                text: "Kerajaan Sriwijaya mencapai puncak kejayaan pada abad ke-7 karena penguasaan perdagangan di Selat Malaka. Salah satu komoditas utama yang diperdagangkan adalah ....",
                options: ["Emas", "Cengkeh", "Lada", "Tembaga"],
                correct: "C"
            },
            {
                type: "multiple",
                text: "Pada masa revolusi kemerdekaan, Konferensi Meja Bundar menghasilkan pengakuan kedaulatan Indonesia. Salah satu syaratnya adalah pembentukan negara ....",
                options: ["Republik Indonesia Serikat", "Negara Indonesia Timur", "Kesultanan Yogyakarta", "Republik Maluku Selatan"],
                correct: "A"
            },
            {
                type: "multiple",
                text: "Struktur sosial masyarakat Minangkabau berdasarkan garis keturunan ibu disebut ....",
                options: ["Patrilineal", "Matrilineal", "Bilateral", "Unilineal"],
                correct: "B"
            },
            {
                type: "multiple",
                text: "Faktor utama yang mendorong masuknya pengaruh Hindu-Buddha ke Indonesia adalah ....",
                options: ["Perang antarkerajaan", "Perdagangan maritim", "Penjajahan Eropa", "Migrasi besar-besaran"],
                correct: "B"
            },
            {
                type: "multiple",
                text: "Wilayah Indonesia yang memiliki potensi geotermal terbesar karena aktivitas vulkanik adalah ....",
                options: ["Sumatera Utara", "Jawa Barat", "Sulawesi Utara", "Nusa Tenggara Timur"],
                correct: "B"
            },
            {
                type: "multiple",
                text: "Pada masa kolonial Inggris, sistem landrent diterapkan di Jawa untuk menggantikan Cultuurstelsel. Sistem ini berfokus pada ....",
                options: ["Pajak tanah berdasarkan luas lahan", "Eksploitasi tenaga kerja petani", "Monopoli perdagangan rempah", "Pengelolaan irigasi sawah"],
                correct: "A"
            },
            {
                type: "multiple",
                text: "Perlawanan Diponegoro di Jawa dipicu oleh penyalahgunaan tanah oleh Belanda, termasuk pembangunan ....",
                options: ["Jalan Anyer-Panarukan", "Benteng Stelsel", "Jembatan Kali Mas", "Pelabuhan Sunda Kelapa"],
                correct: "A"
            },
            {
                type: "multiple",
                text: "Sumber daya alam di Kalimantan yang menjadi penyumbang devisa terbesar adalah ....",
                options: ["Minyak bumi", "Batu bara", "Emas", "Kayu"],
                correct: "A"
            },
            {
                type: "multiple",
                text: "Candi Borobudur mencerminkan pengaruh agama Buddha aliran ....",
                options: ["Theravada", "Mahayana", "Hinayana", "Vajrayana"],
                correct: "B"
            },
            {
                type: "multiple",
                text: "Organisasi Budi Utomo didirikan pada tahun 1908 dengan tujuan utama ....",
                options: ["Kemajuan pendidikan dan budaya", "Perlawanan bersenjata", "Pemisahan wilayah Jawa", "Pembentukan partai politik"],
                correct: "A"
            },
            {
                type: "multiple",
                text: "Wilayah Indonesia yang memiliki keanekaragaman flora dan fauna tipe Australis adalah ....",
                options: ["Jawa", "Sumatera", "Papua", "Kalimantan"],
                correct: "C"
            },
            {
                type: "multiple",
                text: "Pada masa kolonial Portugis, pelabuhan utama di Indonesia adalah ....",
                options: ["Banten", "Malaka", "Makassar", "Surabaya"],
                correct: "B"
            },
            {
                type: "multiple",
                text: "Sistem irigasi tradisional Subak di Bali berfungsi untuk mengatur distribusi air pada lahan ....",
                options: ["Sawah", "Kebun", "Tambak", "Tegalan"],
                correct: "A"
            },
            {
                type: "multiple",
                text: "Faktor utama yang menyebabkan keruntuhan Kerajaan Majapahit adalah ....",
                options: ["Perang saudara Paregreg", "Penjajahan Belanda", "Bencana alam", "Krisis ekonomi"],
                correct: "A"
            },
            {
                type: "multiple",
                text: "Sumber daya mineral yang dominan di Bangka Belitung adalah ....",
                options: ["Timah", "Tembaga", "Nikel", "Besi"],
                correct: "A"
            },
            {
                type: "multiple",
                text: "Pahlawan nasional yang memimpin perlawanan terhadap Belanda di Maluku adalah ....",
                options: ["Sultan Hasanuddin", "Pattimura", "Tuanku Imam Bonjol", "Cut Nyak Dien"],
                correct: "B"
            },
            {
                type: "multiple",
                text: "Konferensi Asia-Afrika 1955 di Bandung bertujuan untuk ....",
                options: ["Memperkuat blok komunis", "Mempromosikan perdamaian dunia", "Mendirikan ASEAN", "Menentang kemerdekaan Indonesia"],
                correct: "B"
            },
            {
                type: "multiple",
                text: "Struktur ekonomi feodal pada masa Kerajaan Mataram Kuno didasarkan pada sistem ....",
                options: ["Perdagangan maritim", "Pajak tanah sawah", "Monopoli rempah", "Perkebunan lada"],
                correct: "B"
            },
            {
                type: "multiple",
                text: "Wilayah Indonesia yang dikenal sebagai penghasil kopi Gayo adalah ....",
                options: ["Aceh", "Jawa Barat", "Toraja", "Sumatera Utara"],
                correct: "A"
            },
            {
                type: "multiple",
                text: "Pada masa kolonial Belanda, VOC mendirikan benteng di wilayah .... untuk menguasai perdagangan rempah",
                options: ["Jakarta", "Ambon", "Surabaya", "Banten"],
                correct: "B"
            },
            {
                type: "multiple",
                text: "Faktor iklim yang memengaruhi persebaran flora di Indonesia adalah ....",
                options: ["Tekanan udara", "Curah hujan", "Ketinggian tanah", "Suhu rata-rata"],
                correct: "B"
            },
            {
                type: "multiple",
                text: "Perlawanan Sultan Hasanuddin di Gowa dipicu oleh monopoli perdagangan oleh ....",
                options: ["Portugis", "Belanda", "Inggris", "Spanyol"],
                correct: "B"
            },
            {
                type: "multiple",
                text: "Sistem ekonomi tradisional pada masyarakat Bugis-Makassar dikenal sebagai ....",
                options: ["Subak", "Ladang berpindah", "Pattun", "Sawah"],
                correct: "B"
            },
            {
                type: "multiple",
                text: "Candi Prambanan merupakan peninggalan agama ....",
                options: ["Buddha", "Hindu", "Islam", "Kristen"],
                correct: "B"
            },
            {
                type: "multiple",
                text: "Sumber daya alam yang menjadi tulang punggung ekonomi di Riau adalah ....",
                options: ["Minyak bumi", "Timah", "Emas", "Nikel"],
                correct: "A"
            },
            {
                type: "multiple",
                text: "Organisasi Sarekat Islam awalnya bertujuan untuk ....",
                options: ["Kemajuan perdagangan pribumi", "Perlawanan politik", "Pendidikan modern", "Pemisahan agama dan negara"],
                correct: "A"
            },
            {
                type: "multiple",
                text: "Perjanjian Linggarjati mengakui kedaulatan Indonesia atas wilayah ....",
                options: ["Jawa dan Madura", "Sumatera", "Kalimantan", "Sulawesi"],
                correct: "A"
            },
            // 20 Short-Answer Questions (Challenging, OSN IPS Level)
            {
                type: "short",
                text: "Persebaran flora di Indonesia sama dengan pola persebaran faunanya yang berpangkal pada sejarah pembentukan daratan kepulauan Indonesia pada masa zaman es. Pada awal zaman es, Dataran Sunda masih bersatu dengan benua Asia dan Dataran ................. yang menyatu dengan benua Australia merupakan daerah migrasi fauna.",
                correct: "SAHUL"
            },
            {
                type: "short",
                text: "Kerajaan Islam di Indonesia yang menjadi pusat pendidikan agama pada abad ke-16 adalah ....",
                correct: "DEMAK"
            },
            {
                type: "short",
                text: "Gunung berapi di Indonesia yang menyebabkan bencana global pada tahun 1815 adalah ....",
                correct: "TAMBORA"
            },
            {
                type: "short",
                text: "Sistem tanam paksa di Jawa pada masa kolonial Belanda dikenal sebagai ....",
                correct: "CULTUURSTELSEL"
            },
            {
                type: "short",
                text: "Pahlawan nasional yang memimpin perlawanan terhadap Belanda di Minangkabau adalah ....",
                correct: "TUANKU IMAM BONJOL"
            },
            {
                type: "short",
                text: "Provinsi di Indonesia yang memiliki potensi wisata bahari terbesar karena kepulauan karangnya adalah ....",
                correct: "NUSA TENGGARA TIMUR"
            },
            {
                type: "short",
                text: "Sistem pemerintahan tradisional pada masyarakat Bali yang mengatur irigasi sawah adalah ....",
                correct: "SUBAK"
            },
            {
                type: "short",
                text: "Organisasi internasional yang didirikan Indonesia pada tahun 1967 bersama negara-negara Asia Tenggara lainnya adalah ....",
                correct: "ASEAN"
            },
            {
                type: "short",
                text: "Suku di Indonesia yang terkenal dengan tradisi rumah adat Tambi adalah ....",
                correct: "LORE"
            },
            {
                type: "short",
                text: "Perjanjian yang mengakhiri kekuasaan Belanda di Indonesia pada tahun 1949 adalah ....",
                correct: "KONFERENSI MEJA BUNDAR"
            },
            {
                type: "short",
                text: "Sumber daya alam utama di Papua yang dikelola oleh perusahaan Freeport adalah ....",
                correct: "TEMBAGA"
            },
            {
                type: "short",
                text: "Tarian tradisional dari Aceh yang diakui UNESCO sebagai warisan budaya adalah ....",
                correct: "SAMAN"
            },
            {
                type: "short",
                text: "Wilayah di Indonesia yang dikenal sebagai penghasil timah terbesar adalah ....",
                correct: "BANGKA BELITUNG"
            },
            {
                type: "short",
                text: "Pahlawan nasional yang memimpin perlawanan Puputan di Bali adalah ....",
                correct: "I GUSTI NGURAH RAI"
            },
            {
                type: "short",
                text: "Sistem ekonomi yang diterapkan VOC di Ambon untuk menguasai perdagangan rempah adalah ....",
                correct: "HONGI TOCHTEN"
            },
            {
                type: "short",
                text: "Gunung berapi aktif di Jawa Tengah yang memiliki nilai sejarah dan budaya adalah ....",
                correct: "MERAPI"
            },
            {
                type: "short",
                text: "Organisasi pergerakan nasional yang didirikan oleh pelajar STOVIA pada tahun 1908 adalah ....",
                correct: "BUDI UTOMO"
            },
            {
                type: "short",
                text: "Sumber daya alam yang menjadi penyumbang devisa terbesar di Kalimantan Timur adalah ....",
                correct: "MINYAK BUMI"
            },
            {
                type: "short",
                text: "Sistem sosial yang mengatur perkawinan pada masyarakat Batak disebut ....",
                correct: "DALIHAH TOLU"
            },
            {
                type: "short",
                text: "Konferensi internasional yang diadakan di Bandung pada tahun 1955 adalah ....",
                correct: "KONFERENSI ASIA AFRIKA"
            }
        ];

        let currentQuestion = 0;
        let score = 0;
        let correctAnswers = 0;
        let startTime = null;
        let timerInterval = null;
        let timeLeft = 30;
        let totalTime = 0;
        let answers = [];
        let redemptionQuestions = [];

        function startQuiz() {
            document.querySelector('.start-screen').classList.add('hidden');
            document.querySelector('.question-screen').classList.remove('hidden');
            startTime = new Date();
            answers = Array(questions.length).fill(null);
            loadQuestion();
        }

        function loadQuestion() {
            const q = questions[currentQuestion];
            timeLeft = q.type === "multiple" ? 30 : 45;
            document.querySelector('.question-number').textContent = `Soal ${currentQuestion + 1}/50`;
            document.querySelector('.question-text').textContent = q.text;
            document.querySelector('.score').textContent = `Skor: ${score}`;
            document.querySelector('.powerup').classList.add('hidden');

            const optionsDiv = document.querySelector('.options');
            const shortAnswerDiv = document.querySelector('.short-answer');
            optionsDiv.innerHTML = '';
            shortAnswerDiv.classList.add('hidden');

            if (q.type === "multiple") {
                optionsDiv.classList.remove('hidden');
                q.options.forEach((option, i) => {
                    const btn = document.createElement('div');
                    btn.classList.add('option', 'bg-yellow-400', 'text-gray-800', 'p-4', 'rounded-lg', 'cursor-pointer', 'transition-all');
                    btn.textContent = `${String.fromCharCode(65 + i)}. ${option}`;
                    btn.onclick = () => checkAnswer(String.fromCharCode(65 + i));
                    optionsDiv.appendChild(btn);
                });
            } else {
                shortAnswerDiv.classList.remove('hidden');
                optionsDiv.classList.add('hidden');
                const input = document.querySelector('.short-answer input');
                input.value = '';
                input.disabled = false;
                document.querySelector('.short-answer .btn').disabled = false;
            }

            startTimer();
        }

        function startTimer() {
            clearInterval(timerInterval);
            const timerProgress = document.querySelector('.timer-progress');
            const timerText = document.querySelector('.timer-text');
            timerProgress.style.width = '100%';
            timerText.textContent = `${timeLeft} detik`;

            timerInterval = setInterval(() => {
                timeLeft--;
                totalTime++;
                timerText.textContent = `${timeLeft} detik`;
                timerProgress.style.width = `${(timeLeft / (questions[currentQuestion].type === "multiple" ? 30 : 45)) * 100}%`;

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    checkAnswer(null);
                }
            }, 1000);
        }

        function checkAnswer(answer) {
            clearInterval(timerInterval);
            const q = questions[currentQuestion];
            let isCorrect = false;

            answers[currentQuestion] = { answer, isCorrect: false };

            if (q.type === "multiple") {
                const options = document.querySelectorAll('.option');
                options.forEach((opt, i) => {
                    if (String.fromCharCode(65 + i) === q.correct) {
                        opt.classList.add('correct', 'bg-green-500', 'text-white');
                    } else if (String.fromCharCode(65 + i) === answer) {
                        opt.classList.add('wrong', 'bg-red-500', 'text-white');
                    }
                    opt.onclick = null;
                });
                isCorrect = answer === q.correct;
            } else {
                const userAnswer = document.querySelector('.short-answer input').value.toUpperCase().replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g, "");
                isCorrect = userAnswer === q.correct;
                const input = document.querySelector('.short-answer input');
                input.classList.add(isCorrect ? 'border-green-500' : 'border-red-500');
                input.disabled = true;
                document.querySelector('.short-answer .btn').disabled = true;
            }

            answers[currentQuestion].isCorrect = isCorrect;

            if (isCorrect) {
                score += 10;
                correctAnswers++;
                if (timeLeft > (q.type === "multiple" ? 20 : 35)) {
                    totalTime -= 10;
                    document.querySelector('.powerup').classList.remove('hidden');
                    Swal.fire({
                        title: 'Power-up!',
                        text: 'Kamu mendapat +10 detik karena menjawab dalam waktu kurang dari 10 detik! ðŸ”¥',
                        icon: 'success',
                        timer: 1500,
                        showConfirmButton: false
                    });
                }
            }

            setTimeout(() => {
                currentQuestion++;
                if (currentQuestion < questions.length) {
                    loadQuestion();
                } else {
                    showResult();
                }
            }, 1000);
        }

        function checkShortAnswer() {
            const answer = document.querySelector('.short-answer input').value;
            checkAnswer(answer);
        }

        function showResult() {
            document.querySelector('.question-screen').classList.add('hidden');
            document.querySelector('.result-screen').classList.remove('hidden');
            const timeTaken = Math.floor((new Date() - startTime) / 1000);
            document.getElementById('total-score').textContent = `Skor Total: ${score}`;
            document.getElementById('correct-answers').textContent = `Jawaban Benar: ${correctAnswers}/50`;
            document.getElementById('time-taken').textContent = `Waktu: ${Math.floor(timeTaken / 60)} menit ${timeTaken % 60} detik`;

            const incorrectQuestions = answers
                .map((ans, i) => ({ index: i, isCorrect: ans ? ans.isCorrect : false }))
                .filter(ans => !ans.isCorrect)
                .map(ans => ans.index);

            if (incorrectQuestions.length > 0) {
                document.querySelector('.redemption').classList.remove('hidden');
                const redemptionOptions = document.getElementById('redemption-options');
                redemptionOptions.innerHTML = '';
                incorrectQuestions.forEach(i => {
                    const btn = document.createElement('button');
                    btn.classList.add('btn', 'bg-gray-200', 'text-gray-800', 'px-3', 'py-1', 'rounded-lg');
                    btn.textContent = `Soal ${i + 1}`;
                    btn.onclick = () => toggleRedemptionQuestion(i);
                    redemptionOptions.appendChild(btn);
                });
            }

            updateLeaderboard(score, timeTaken);
        }

        function toggleRedemptionQuestion(index) {
            if (redemptionQuestions.includes(index)) {
                redemptionQuestions = redemptionQuestions.filter(i => i !== index);
            } else if (redemptionQuestions.length < 3) {
                redemptionQuestions.push(index);
            } else {
                Swal.fire({
                    title: 'Batas Tercapai',
                    text: 'Kamu hanya bisa memilih 3 soal untuk redemption quiz!',
                    icon: 'warning',
                    timer: 1500,
                    showConfirmButton: false
                });
                return;
            }
            const buttons = document.querySelectorAll('#redemption-options button');
            buttons.forEach(btn => {
                const i = parseInt(btn.textContent.replace('Soal ', '')) - 1;
                btn.classList.toggle('bg-orange-500', redemptionQuestions.includes(i));
                btn.classList.toggle('text-white', redemptionQuestions.includes(i));
                btn.classList.toggle('bg-gray-200', !redemptionQuestions.includes(i));
                btn.classList.toggle('text-gray-800', !redemptionQuestions.includes(i));
            });
        }

        function startRedemption() {
            if (redemptionQuestions.length === 0) {
                Swal.fire({
                    title: 'Pilih Soal',
                    text: 'Silakan pilih minimal satu soal untuk redemption quiz!',
                    icon: 'warning',
                    timer: 1500,
                    showConfirmButton: false
                });
                return;
            }
            currentQuestion = redemptionQuestions[0];
            redemptionQuestions = redemptionQuestions.slice(1);
            score -= answers.filter(ans => ans && ans.isCorrect).length * 10;
            correctAnswers = 0;
            answers = Array(questions.length).fill(null);
            document.querySelector('.result-screen').classList.add('hidden');
            document.querySelector('.question-screen').classList.remove('hidden');
            loadQuestion();
        }

        function updateLeaderboard(score, timeTaken) {
            const leaderboard = JSON.parse(localStorage.getItem('leaderboard') || '[]');
            Swal.fire({
                title: 'Masukkan Nama',
                input: 'text',
                inputPlaceholder: 'Nama untuk leaderboard',
                showCancelButton: true,
                confirmButtonText: 'Simpan',
                confirmButtonColor: '#ff6b00',
                cancelButtonColor: '#f4c425'
            }).then(result => {
                if (result.isConfirmed && result.value) {
                    leaderboard.push({ name: result.value, score, time: timeTaken });
                    leaderboard.sort((a, b) => b.score - a.score || a.time - b.time);
                    localStorage.setItem('leaderboard', JSON.stringify(leaderboard.slice(0, 5)));

                    const list = document.getElementById('leaderboard-list');
                    list.innerHTML = '';
                    leaderboard.slice(0, 5).forEach((entry, i) => {
                        const li = document.createElement('li');
                        li.classList.add('bg-yellow-400', 'text-gray-800', 'p-2', 'rounded', 'my-1');
                        li.textContent = `${i + 1}. ${entry.name}: ${entry.score} (${Math.floor(entry.time / 60)}m ${entry.time % 60}s)`;
                        list.appendChild(li);
                    });
                }
            });
        }

        function playAgain() {
            currentQuestion = 0;
            score = 0;
            correctAnswers = 0;
            totalTime = 0;
            redemptionQuestions = [];
            answers = [];
            document.querySelector('.result-screen').classList.add('hidden');
            document.querySelector('.question-screen').classList.remove('hidden');
            startTime = new Date();
            loadQuestion();
        }

        function shareScore() {
            Swal.fire({
                title: 'Bagikan Skor',
                text: 'Fitur ini belum diimplementasikan. Silakan screenshot hasilmu!',
                icon: 'info',
                confirmButtonColor: '#ff6b00'
            });
        }

        function showAdmin() {
            document.querySelector('.start-screen').classList.add('hidden');
            document.querySelector('.admin-section').classList.remove('hidden');
            document.getElementById('question-type').onchange = function() {
                const isMultiple = this.value === "multiple";
                document.getElementById('option-a').classList.toggle('hidden', !isMultiple);
                document.getElementById('option-b').classList.toggle('hidden', !isMultiple);
                document.getElementById('option-c').classList.toggle('hidden', !isMultiple);
                document.getElementById('option-d').classList.toggle('hidden', !isMultiple);
            };
        }

        function hideAdmin() {
            document.querySelector('.admin-section').classList.add('hidden');
            document.querySelector('.start-screen').classList.remove('hidden');
        }

        function addQuestion() {
            const type = document.getElementById('question-type').value;
            const text = document.getElementById('question-text').value;
            const correct = document.getElementById('correct-answer').value.toUpperCase();
            if (!text || !correct) {
                Swal.fire({
                    title: 'Error',
                    text: 'Teks soal dan jawaban benar harus diisi!',
                    icon: 'error',
                    confirmButtonColor: '#ff6b00'
                });
                return;
            }
            const newQuestion = { type, text, correct };

            if (type === "multiple") {
                const options = [
                    document.getElementById('option-a').value,
                    document.getElementById('option-b').value,
                    document.getElementById('option-c').value,
                    document.getElementById('option-d').value
                ];
                if (options.some(opt => !opt)) {
                    Swal.fire({
                        title: 'Error',
                        text: 'Semua pilihan harus diisi untuk soal pilihan ganda!',
                        icon: 'error',
                        confirmButtonColor: '#ff6b00'
                    });
                    return;
                }
                newQuestion.options = options;
            }

            questions.push(newQuestion);
            Swal.fire({
                title: 'Sukses',
                text: 'Soal berhasil ditambahkan!',
                icon: 'success',
                timer: 1500,
                showConfirmButton: false
            });
            hideAdmin();
        }

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            document.querySelectorAll('.bg-white').forEach(el => el.classList.toggle('dark:bg-gray-800'));
            document.querySelectorAll('.text-gray-600').forEach(el => el.classList.toggle('dark:text-gray-300'));
        }
    </script>
</body>
</html>
